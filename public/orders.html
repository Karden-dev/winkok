<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WINK EXPRESS - Gestion des commandes</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <style>
        :root {
            --bs-corail: #FF7F50;
            --bs-bleu-profond: #2C3E50;
            --bs-bleu-celeste: #4A6491;
            --bs-blanc-creme: #F8F9FA;
            --bs-gris-anthracite: #34495E;
        }
        body {
            background-color: var(--bs-blanc-creme);
            font-family: sans-serif;
            overflow-x: hidden;
            display: flex;
            min-height: 100vh;
        }
        .sidebar {
            width: 250px;
            background-color: var(--bs-bleu-profond);
            min-height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            color: white;
            padding: 20px;
            transition: all 0.3s;
            z-index: 1000;
        }
        .sidebar.collapsed {
            margin-left: -250px;
        }
        .main-content {
            margin-left: 250px;
            padding: 20px;
            flex-grow: 1;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
        }
        .main-content.expanded {
            margin-left: 0;
        }
        .nav-link {
            color: white;
            padding: 10px 15px;
            margin-bottom: 5px;
            border-radius: 5px;
        }
        .nav-link:hover {
            background-color: var(--bs-bleu-celeste);
            color: white;
        }
        .nav-link.active {
            background-color: var(--bs-corail);
            color: white;
        }
        .top-header {
            background-color: white;
            padding: 15px 20px;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        .top-header .toggler {
            font-size: 1.5rem;
            color: var(--bs-bleu-profond);
            cursor: pointer;
        }
        .header-title-container {
            flex-grow: 1;
        }
        .header-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .card {
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .table-responsive {
            flex-grow: 1;
            overflow-y: auto;
        }
        .table thead {
            background-color: var(--bs-bleu-profond);
            color: white;
            font-size: 0.8rem;
            position: sticky;
            top: 0;
            z-index: 1;
        }
        .table td {
            font-size: 0.85rem;
            white-space: nowrap;
        }
        .btn-corail {
            background-color: var(--bs-corail);
            border-color: var(--bs-corail);
            color: white;
        }
        .btn-corail:hover {
            background-color: #FF6347;
            border-color: #FF6347;
            color: white;
        }
        .search-container {
            position: relative;
            width: 100%;
        }
        .search-results {
            position: absolute;
            z-index: 10;
            width: 100%;
            background: white;
            border: 1px solid #ced4da;
            border-top: none;
            max-height: 200px;
            overflow-y: auto;
            border-radius: 0 0 5px 5px;
        }
        .search-results div {
            padding: 8px 12px;
            cursor: pointer;
        }
        .search-results div:hover {
            background-color: #f0f0f0;
        }
        .dropdown-submenu {
            position: relative;
        }
        .dropdown-submenu .dropdown-menu {
            top: 0;
            left: 100%;
            margin-top: -1px;
        }
        .dropdown-item i {
            margin-right: 8px;
        }
        .modal-add-order {
            max-width: 700px;
        }
        .modal-content {
            height: auto;
        }
        .modal-body {
            max-height: 70vh;
            overflow-y: auto;
        }
        .item-row {
            display: flex;
            align-items: flex-end;
        }
        .remove-item-btn {
            background: none;
            border: none;
            color: #dc3545;
            font-size: 1.25rem;
            cursor: pointer;
            margin-left: 5px;
            padding: 0;
            line-height: 1;
        }
        .table > :not(caption)>*>* {
            padding: 0.4rem 0.5rem;
        }
        .table th, .table td {
            vertical-align: middle;
        }
        .table .btn-sm {
            padding: 0.2rem 0.4rem;
            font-size: 0.75rem;
        }
        .table .dropdown-menu {
            min-width: 150px;
        }
        .table .badge {
            font-size: 0.7rem;
        }
        .table .bi {
            font-size: 0.9rem;
        }
        .status-container, .payment-container {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .status-container .bi, .payment-container .bi {
            font-size: 0.6rem;
        }
        .status-pending { color: #ffc107; }
        .status-in_progress { color: #17a2b8; }
        .status-delivered { color: #28a745; }
        .status-cancelled { color: #dc3545; }
        .status-failed_delivery { color: #dc3545; }
        .status-reported { color: #480CA8; }
        .payment-pending { color: #ffc107; }
        .payment-cash { color: #28a745; }
        .payment-supplier_paid { color: #17a2b8; }
        .payment-cancelled { color: #dc3545; }
        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        #notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
        }
        .filter-header-container {
            display: flex;
            align-items: flex-end;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }
        .filter-controls {
            display: flex;
            flex-grow: 1;
            gap: 0.5rem;
        }
        .search-input-group {
            flex-grow: 1;
            max-width: 250px;
        }
        .date-input-group, .status-input-group {
            width: 170px;
            flex-shrink: 0;
        }
        .status-dropdown-container {
            width: 170px; /* Largeur fixe pour le conteneur du bouton de statut */
        }
        .status-dropdown-container .dropdown-toggle {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .status-dropdown-menu {
            width: 100%;
        }
    </style>
</head>
<body>
    <div id="notification-container"></div>
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header d-flex justify-content-center">
            <img src="wink-logo.png" alt="Logo WINK EXPRESS" style="width: 150px;">
        </div>
        <ul class="nav flex-column mt-4">
            <li class="nav-item"><a class="nav-link" href="dashboard.html"><i class="bi bi-speedometer2"></i> Tableau de bord</a></li>
            <li class="nav-item"><a class="nav-link" href="orders.html"><i class="bi bi-box-seam"></i> Commandes</a></li>
            <li class="nav-item"><a class="nav-link" href="deliverymen.html"><i class="bi bi-bicycle"></i> Livreurs</a></li>
            <li class="nav-item"><a class="nav-link" href="shops.html"><i class="bi bi-shop"></i> Marchands</a></li>
            <li class="nav-item"><a class="nav-link" href="reports.html"><i class="bi bi-file-earmark-bar-graph"></i> Rapports</a></li>
            <li class="nav-item"><a class="nav-link" href="remittances.html"><i class="bi bi-wallet"></i> Versements</a></li>
            <li class="nav-item"><a class="nav-link" href="users.html"><i class="bi bi-person"></i> Utilisateurs</a></li>
        </ul>
    </div>

    <div class="main-content" id="main-content">
        <div class="top-header">
            <i class="bi bi-list toggler" id="sidebar-toggler"></i>
            <h1 class="header-title-container h4 mb-0 ms-3">Gestion des commandes</h1>
            <div class="header-actions">
                <button class="btn btn-sm btn-corail" data-bs-toggle="modal" data-bs-target="#addOrderModal">
                    <i class="bi bi-plus-circle me-1"></i> Ajouter une commande
                </button>
                <div class="dropdown">
                    <a href="#" class="d-flex align-items-center text-dark text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="https://ui-avatars.com/api/?name=A&size=32&background=2C3E50&color=fff&rounded=true" alt="Avatar" width="32" height="32" class="rounded-circle me-2">
                        <span id="userName">Admin</span>
                    </a>
                    <ul class="dropdown-menu text-small shadow">
                        <li><a class="dropdown-item" href="#">Profil</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" id="logoutBtn">Déconnexion</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <hr class="mt-4">

        <div class="filter-header-container">
            <div class="filter-controls">
                <div class="input-group input-group-sm search-input-group">
                    <label for="searchInput" class="input-group-text">Rechercher</label>
                    <input type="text" class="form-control" placeholder="Commande, client..." id="searchInput">
                </div>
                <div class="input-group input-group-sm date-input-group">
                    <label for="startDateFilter" class="input-group-text">Du</label>
                    <input type="date" class="form-control" id="startDateFilter">
                </div>
                <div class="input-group input-group-sm date-input-group">
                    <label for="endDateFilter" class="input-group-text">Au</label>
                    <input type="date" class="form-control" id="endDateFilter">
                </div>
                <div class="dropdown status-dropdown-container">
                    <button class="btn btn-outline-secondary btn-sm status-dropdown-button dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" id="statusFilterBtn">
                        Statut : Tous
                    </button>
                    <ul class="dropdown-menu status-dropdown-menu" id="statusFilterMenu">
                        <li><a class="dropdown-item status-filter-option" href="#" data-status="">Tous</a></li>
                        <li><a class="dropdown-item status-filter-option" href="#" data-status="pending">En attente</a></li>
                        <li><a class="dropdown-item status-filter-option" href="#" data-status="in_progress">En cours</a></li>
                        <li><a class="dropdown-item status-filter-option" href="#" data-status="delivered">Livrée</a></li>
                        <li><a class="dropdown-item status-filter-option" href="#" data-status="cancelled">Annulée</a></li>
                        <li><a class="dropdown-item status-filter-option" href="#" data-status="failed_delivery">Livraison ratée</a></li>
                        <li><a class="dropdown-item status-filter-option" href="#" data-status="reported">À relancer</a></li>
                    </ul>
                </div>
            </div>
            <div class="d-flex align-items-end gap-2">
                <button class="btn btn-sm btn-secondary" id="filterBtn">Filtrer</button>
                <div class="dropdown" id="bulkActionsDropdown">
                    <button class="btn btn-sm btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Actions groupées
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item bulk-assign-btn" href="#"><i class="bi bi-person"></i> Attribuer un livreur</a></li>
                        <li><a class="dropdown-item bulk-delete-btn" href="#"><i class="bi bi-trash"></i> Supprimer</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item bulk-status-delivered-btn" href="#" data-bs-toggle="modal" data-bs-target="#bulkStatusActionModal"><i class="bi bi-check-circle"></i> Statuer Livrée</a></li>
                        <li><a class="dropdown-item bulk-status-failed-btn" href="#" data-bs-toggle="modal" data-bs-target="#bulkFailedDeliveryModal"><i class="bi bi-x-circle"></i> Statuer Livraison ratée</a></li>
                        <li><a class="dropdown-item bulk-status-cancel-btn" href="#"><i class="bi bi-slash-circle"></i> Annuler</a></li>
                        <li><a class="dropdown-item bulk-status-reported-btn" href="#"><i class="bi bi-clock"></i> À relancer</a></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="card p-4">
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAllCheckbox"></th>
                            <th>Marchand</th>
                            <th>Client</th>
                            <th>Lieu</th>
                            <th>Produit</th>
                            <th>Montant article</th>
                            <th>Frais liv.</th>
                            <th>Montant à verser</th>
                            <th>Paiement</th>
                            <th>Statut</th>
                            <th>Livreur</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        </tbody>
                </table>
            </div>
            <div class="pagination-container">
                <div class="d-flex align-items-center gap-2">
                    <label for="itemsPerPage" class="form-label mb-0 me-2 text-nowrap">Lignes par page:</label>
                    <select class="form-select form-select-sm w-auto" id="itemsPerPage">
                        <option value="10">10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="d-flex align-items-center">
                    <span id="paginationInfo" class="me-3"></span>
                    <nav aria-label="Page navigation">
                        <ul class="pagination pagination-sm mb-0">
                            <li class="page-item" id="firstPage"><a class="page-link" href="#"><i class="bi bi-skip-start-fill"></i></a></li>
                            <li class="page-item" id="prevPage"><a class="page-link" href="#"><i class="bi bi-caret-left-fill"></i></a></li>
                            <li class="page-item disabled"><span class="page-link" id="currentPageDisplay">1</span></li>
                            <li class="page-item" id="nextPage"><a class="page-link" href="#"><i class="bi bi-caret-right-fill"></i></a></li>
                            <li class="page-item" id="lastPage"><a class="page-link" href="#"><i class="bi bi-skip-end-fill"></i></a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>

    </div>

    <div class="modal fade" id="addOrderModal" tabindex="-1" aria-labelledby="addOrderModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-add-order">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addOrderModalLabel">Ajouter une nouvelle commande</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="addOrderForm">
                    <div class="modal-body">
                        <div class="mb-2">
                            <label for="shopSearchInput" class="form-label mb-1">Marchand</label>
                            <div class="input-group">
                                <input type="text" class="form-control form-control-sm" id="shopSearchInput" placeholder="Rechercher un marchand" required>
                                <button class="btn btn-sm btn-outline-secondary" type="button" data-bs-toggle="modal" data-bs-target="#addShopModal"><i class="bi bi-plus"></i></button>
                            </div>
                            <div id="searchResults" class="search-results d-none"></div>
                            <input type="hidden" id="selectedShopId">
                        </div>
                        <div class="mb-2">
                            <label for="customerName" class="form-label mb-1">Nom du client</label>
                            <input type="text" class="form-control form-control-sm" id="customerName">
                        </div>
                        <div class="mb-2">
                            <label for="customerPhone" class="form-label mb-1">Numéro de tél. du client</label>
                            <input type="tel" class="form-control form-control-sm" id="customerPhone" placeholder="Ex: 690 48 49 89" required>
                        </div>
                        <div class="mb-2">
                            <label for="deliveryLocation" class="form-label mb-1">Lieu de livraison</label>
                            <input type="text" class="form-control form-control-sm" id="deliveryLocation" placeholder="Ex: Bastos" required>
                        </div>
                        
                        <hr class="my-3">
                        
                        <h6 class="d-flex justify-content-between align-items-center mb-2">
                            Articles
                            <button type="button" class="btn btn-secondary btn-sm" id="addItemBtn">
                                <i class="bi bi-plus-circle"></i>
                            </button>
                        </h6>
                        <div id="itemsContainer">
                            <div class="row g-2 item-row mb-2">
                                <div class="col-md-5">
                                    <label for="itemName-0" class="form-label mb-1">Nom article</label>
                                    <input type="text" class="form-control form-control-sm item-name-input" id="itemName-0" placeholder="Ex: T-shirt" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="itemQuantity-0" class="form-label mb-1">Qté</label>
                                    <input type="number" class="form-control form-control-sm item-quantity-input" id="itemQuantity-0" value="1" min="1" required>
                                </div>
                                <div class="col-md-4">
                                    <label for="itemAmount-0" class="form-label mb-1">Montant</label>
                                    <div class="input-group input-group-sm">
                                        <input type="number" class="form-control item-amount-input" id="itemAmount-0" value="0" min="0" required>
                                        <button class="btn btn-outline-danger remove-item-btn" type="button"><i class="bi bi-trash"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <hr class="my-3">

                        <div class="mb-2 form-check">
                            <input class="form-check-input" type="checkbox" id="isExpedition">
                            <label class="form-check-label" for="isExpedition">C'est une expédition</label>
                        </div>
                        
                        <div id="expeditionFeeContainer" class="mb-2" style="display: none;">
                            <label for="expeditionFee" class="form-label mb-1">Frais d'expédition</label>
                            <input type="number" class="form-control form-control-sm" id="expeditionFee" value="0">
                        </div>

                        <div class="mb-2">
                            <label for="deliveryFee" class="form-label mb-1">Frais de livraison</label>
                            <input type="number" class="form-control form-control-sm" id="deliveryFee" value="0" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                        <button type="submit" class="btn btn-corail">Ajouter une nouvelle commande</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="addShopModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header"><h5 class="modal-title" id="addShopModalLabel">Ajouter un nouveau marchand</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <form id="addShopForm">
                    <div class="modal-body">
                        <div class="mb-3"><label for="newShopName" class="form-label">Nom du marchand</label><input type="text" class="form-control" id="newShopName" required></div>
                        <div class="mb-3"><label for="newShopPhone" class="form-label">Numéro de téléphone</label><input type="tel" class="form-control" id="newShopPhone" required></div>
                        <hr>
                        <p class="fw-bold mb-2">Options de Facturation</p>
                        <div class="form-check form-switch mb-2">
                            <input class="form-check-input" type="checkbox" role="switch" id="newBillPackaging"><label class="form-check-label" for="newBillPackaging">Activer la facturation des emballages</label>
                        </div>
                        <div class="input-group input-group-sm mb-3">
                            <span class="input-group-text">Prix</span>
                            <input type="number" class="form-control" id="newPackagingPrice" value="50" min="0">
                            <span class="input-group-text">FCFA</span>
                        </div>
                        <div class="form-check form-switch mb-2">
                            <input class="form-check-input" type="checkbox" role="switch" id="newBillStorage"><label class="form-check-label" for="newBillStorage">Activer la facturation du stockage</label>
                        </div>
                        <div class="input-group input-group-sm">
                            <span class="input-group-text">Prix</span>
                            <input type="number" class="form-control" id="newStoragePrice" value="100" min="0">
                             <span class="input-group-text">FCFA / jour</span>
                        </div>
                    </div>
                    <div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button><button type="submit" class="btn btn-corail" id="newShopSubmitBtn">Ajouter</button></div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="editOrderModal" tabindex="-1" aria-labelledby="editOrderModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-add-order">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editOrderModalLabel">Modifier la commande</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="editOrderForm">
                    <input type="hidden" id="editDeliverymanId">
                    <div class="modal-body">
                        <input type="hidden" id="editOrderId">
                        <div class="mb-2">
                            <label for="editShopSearchInput" class="form-label mb-1">Marchand</label>
                            <div class="search-container">
                                <input type="text" class="form-control form-control-sm" id="editShopSearchInput" placeholder="Rechercher un marchand" required>
                                <div id="editSearchResults" class="search-results d-none"></div>
                                <input type="hidden" id="editSelectedShopId">
                            </div>
                        </div>
                        <div class="mb-2">
                            <label for="editCustomerName" class="form-label mb-1">Nom du client</label>
                            <input type="text" class="form-control form-control-sm" id="editCustomerName">
                        </div>
                        <div class="mb-2">
                            <label for="editCustomerPhone" class="form-label mb-1">Numéro de tél. du client</label>
                            <input type="tel" class="form-control form-control-sm" id="editCustomerPhone" placeholder="Ex: 690 48 49 89" required>
                        </div>
                        <div class="mb-2">
                            <label for="editDeliveryLocation" class="form-label mb-1">Lieu de livraison</label>
                            <input type="text" class="form-control form-control-sm" id="editDeliveryLocation" placeholder="Ex: Bastos" required>
                        </div>
                        
                        <div class="mb-2">
                            <label for="editCreatedAt" class="form-label mb-1">Date et heure de la commande</label>
                            <input type="datetime-local" class="form-control form-control-sm" id="editCreatedAt" required>
                        </div>
                        
                        <hr class="my-3">
                        
                        <h6 class="d-flex justify-content-between align-items-center mb-2">
                            Articles
                            <button type="button" class="btn btn-secondary btn-sm" id="editAddItemBtn">
                                <i class="bi bi-plus-circle"></i>
                            </button>
                        </h6>
                        <div id="editItemsContainer">
                            </div>

                        <hr class="my-3">

                        <div class="mb-2 form-check">
                            <input class="form-check-input" type="checkbox" id="editIsExpedition">
                            <label class="form-check-label" for="editIsExpedition">C'est une expédition</label>
                        </div>
                        
                        <div id="editExpeditionFeeContainer" class="mb-2" style="display: none;">
                            <label for="editExpeditionFee" class="form-label mb-1">Frais d'expédition</label>
                            <input type="number" class="form-control form-control-sm" id="editExpeditionFee" value="0">
                        </div>

                        <div class="mb-2">
                            <label for="editDeliveryFee" class="form-label mb-1">Frais de livraison</label>
                            <input type="number" class="form-control form-control-sm" id="editDeliveryFee" value="0" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                        <button type="submit" class="btn btn-corail">Enregistrer les modifications</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="statusActionModal" tabindex="-1" aria-labelledby="statusActionModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="statusActionModalLabel">Modifier le statut</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="deliveredPaymentForm" class="d-none">
                        <p>Sélectionnez le mode de paiement :</p>
                        <div class="d-flex gap-2">
                            <button type="button" class="btn btn-success flex-grow-1" id="paymentCashBtn"><i class="bi bi-cash me-2"></i>Cash</button>
                            <button type="button" class="btn btn-info flex-grow-1" id="paymentSupplierBtn"><i class="bi bi-phone me-2"></i>Mobile Money</button>
                        </div>
                    </div>
                    <form id="failedDeliveryForm" class="d-none">
                        <div class="mb-3">
                            <label for="amountReceived" class="form-label">Montant reçu du client (si paiement partiel)</label>
                            <input type="number" class="form-control" id="amountReceived" value="0" placeholder="0">
                        </div>
                        <button type="submit" class="btn btn-corail">Confirmer</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="assignDeliveryModal" tabindex="-1" aria-labelledby="assignDeliveryModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="assignDeliveryModalLabel">Assigner un livreur</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="assignDeliveryForm">
                    <div class="modal-body">
                         <div class="mb-3">
                            <label for="deliverymanSearchInput" class="form-label">Rechercher un livreur</label>
                            <div class="search-container">
                                <input type="text" class="form-control" id="deliverymanSearchInput" placeholder="Nom du livreur...">
                                <div id="deliverymanSearchResults" class="search-results d-none"></div>
                            </div>
                            <input type="hidden" id="assignDeliverymanId">
                        </div>
                        <hr>
                        <h6>Commandes sélectionnées</h6>
                        <p class="text-muted">ID des commandes : <span id="selectedOrdersIds">Aucune</span></p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                        <button type="submit" class="btn btn-corail"><i class="bi bi-person-check me-2"></i>Assigner</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal fade" id="bulkStatusActionModal" tabindex="-1" aria-labelledby="bulkStatusActionModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="bulkStatusActionModalLabel">Modifier le statut de plusieurs commandes</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Sélectionnez le mode de paiement pour les commandes livrées :</p>
                    <div id="bulkDeliveredPaymentForm">
                        <div class="d-flex gap-2">
                            <button type="button" class="btn btn-success flex-grow-1" id="bulkPaymentCashBtn"><i class="bi bi-cash me-2"></i>Cash</button>
                            <button type="button" class="btn btn-info flex-grow-1" id="bulkPaymentSupplierBtn"><i class="bi bi-phone me-2"></i>Mobile Money</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="bulkFailedDeliveryModal" tabindex="-1" aria-labelledby="bulkFailedDeliveryModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="bulkFailedDeliveryModalLabel">Statuer comme "Livraison ratée"</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="bulkFailedDeliveryForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="bulkAmountReceived" class="form-label">Montant reçu des clients (si paiement partiel)</label>
                            <input type="number" class="form-control" id="bulkAmountReceived" value="0" placeholder="0">
                        </div>
                        <button type="submit" class="btn btn-corail">Confirmer</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="orderDetailsModal" tabindex="-1" aria-labelledby="orderDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="orderDetailsModalLabel">Détails de la commande</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="orderDetailsContent">
                        </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="js/orders.js"></script>
</body>
</html>